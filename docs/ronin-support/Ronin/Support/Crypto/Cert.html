<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Ronin::Support::Crypto::Cert
  
    &mdash; Ronin::Support Documentation
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Ronin::Support::Crypto::Cert";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span>
     &raquo; 
    <span class="title">Cert</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Ronin::Support::Crypto::Cert
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">OpenSSL::X509::Certificate</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OpenSSL::X509::Certificate</li>
          
            <li class="next">Ronin::Support::Crypto::Cert</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ronin/support/crypto/cert.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Represents a X509 or TLS certificate.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="ONE_YEAR-constant" class="">ONE_YEAR =
          <div class="docstring">
  <div class="discussion">
    <p>One year in seconds</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='int'>60</span> <span class='op'>*</span> <span class='int'>60</span> <span class='op'>*</span> <span class='int'>24</span> <span class='op'>*</span> <span class='int'>365</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate-class_method" title="generate (class method)">.<strong>generate</strong>(version: 2, serial: 0, not_before: Time.now, not_after: not_before + ONE_YEAR, subject: nil, extensions: nil, key:, ca_cert: nil, ca_key: nil, signing_hash: :sha256)  &#x21d2; Cert </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Generates and signs a new certificate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load-class_method" title="load (class method)">.<strong>load</strong>(buffer)  &#x21d2; Cert </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Parses the PEM encoded certificate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_file-class_method" title="load_file (class method)">.<strong>load_file</strong>(path)  &#x21d2; Cert </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Loads the certificate from the file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Name-class_method" title="Name (class method)">.<strong>Name</strong>(name)  &#x21d2; Cert::Name </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Coerces a value into a <span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span> object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(string)  &#x21d2; Cert </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Parses the PEM encoded certificate string.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#common_name-instance_method" title="#common_name (instance method)">#<strong>common_name</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The subjects common name (<code>CN</code>) entry.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extension_names-instance_method" title="#extension_names (instance method)">#<strong>extension_names</strong>  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The extension OID names.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extension_value-instance_method" title="#extension_value (instance method)">#<strong>extension_value</strong>(oid)  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Gets the value for the extension with the matching OID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extensions_hash-instance_method" title="#extensions_hash (instance method)">#<strong>extensions_hash</strong>  &#x21d2; Hash{String =&gt; OpenSSL::X509::Extension} </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Converts the certificate&#39;s extensions into a Hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#issuer-instance_method" title="#issuer (instance method)">#<strong>issuer</strong>  &#x21d2; Name<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The issuer of the certificate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save-instance_method" title="#save (instance method)">#<strong>save</strong>(path, encoding: :pem)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Saves the certificate to the given path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subject-instance_method" title="#subject (instance method)">#<strong>subject</strong>  &#x21d2; Name<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The subject of the certificate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subject_alt_name-instance_method" title="#subject_alt_name (instance method)">#<strong>subject_alt_name</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Retrieves the <code>subjectAltName</code> extension and parses it&#39;s contents.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subject_alt_names-instance_method" title="#subject_alt_names (instance method)">#<strong>subject_alt_names</strong>  &#x21d2; Array&lt;String&gt;<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Retrieves the <code>subjectAltName</code> extension and parses it&#39;s value.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate-class_method">
  
    .<strong>generate</strong>(version: 2, serial: 0, not_before: Time.now, not_after: not_before + ONE_YEAR, subject: nil, extensions: nil, key:, ca_cert: nil, ca_key: nil, signing_hash: :sha256)  &#x21d2; <tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Generates and signs a new certificate.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Generate a self-signed certificate for <code>localhost</code>:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_key'>key</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key.html" title="Ronin::Support::Crypto::Key (module)">Key</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key/RSA.html" title="Ronin::Support::Crypto::Key::RSA (class)">RSA</a></span></span><span class='period'>.</span><span class='id identifier rubyid_random'>random</span>
<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span>
  <span class='label'>key:</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
  <span class='label'>subject:</span> <span class='lbrace'>{</span>
    <span class='label'>common_name:</span>         <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organization:</span>        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test Co.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organizational_unit:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test Dept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>locality:</span>            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test City</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>state:</span>               <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>XX</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>country:</span>             <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>US</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='label'>extensions:</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DNS: localhost, IP: 127.0.0.1</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>
<span class='rparen'>)</span>
<span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cert.key</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Generate a CA certificate:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_ca_key'>ca_key</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key.html" title="Ronin::Support::Crypto::Key (module)">Key</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key/RSA.html" title="Ronin::Support::Crypto::Key::RSA (class)">RSA</a></span></span><span class='period'>.</span><span class='id identifier rubyid_random'>random</span>
<span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span>
  <span class='label'>key:</span> <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span>
  <span class='label'>subject:</span> <span class='lbrace'>{</span>
    <span class='label'>common_name:</span>         <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test CA</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organization:</span>        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test CA, Inc.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organizational_unit:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test Dept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>locality:</span>            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test City</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>state:</span>               <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>XX</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>country:</span>             <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>US</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='label'>extensions:</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:TRUE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
<span class='rparen'>)</span>
<span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca.key</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ca.pem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Generate a sub-certificate from a CA certificate:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_key'>key</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key.html" title="Ronin::Support::Crypto::Key (module)">Key</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Key/RSA.html" title="Ronin::Support::Crypto::Key::RSA (class)">RSA</a></span></span><span class='period'>.</span><span class='id identifier rubyid_random'>random</span>
<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Support.html" title="Ronin::Support (module)">Support</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Crypto.html" title="Ronin::Support::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span>
  <span class='label'>key:</span>     <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
  <span class='label'>ca_key:</span>  <span class='id identifier rubyid_ca_key'>ca_key</span><span class='comma'>,</span>
  <span class='label'>ca_cert:</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='comma'>,</span>
  <span class='label'>subject:</span> <span class='lbrace'>{</span>
    <span class='label'>common_name:</span>         <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organization:</span>        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test Co.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>organizational_unit:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test Dept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>locality:</span>            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test City</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>state:</span>               <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>XX</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>country:</span>             <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>US</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='label'>extensions:</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DNS: *.test.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
<span class='rparen'>)</span>
<span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cert.key</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cert.pem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>version</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Integer.html" title="Integer (class)">Integer</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>2</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The version of the encoded certificate.
See <a href="https://datatracker.ietf.org/doc/html/rfc5280">RFC 5280</a>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>serial</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Integer.html" title="Integer (class)">Integer</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The certificate serial number.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subject</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>, <tt>Hash{Symbol =&gt; <span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span>,nil}</tt>, <tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The subject field for the certificate. If a <code>Hash</code> is given it will
be passed to <span class='object_link'><a href="Cert/Name.html#build-class_method" title="Ronin::Support::Crypto::Cert::Name.build (method)">Ronin::Support::Crypto::Cert::Name.build</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>not_before</span>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Time.now</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Beginning time when the certificate is valid.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>not_after</span>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>not_before + ONE_YEAR</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>When the certificate expires and is no longer valid.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>extensions</span>
      
      
        <span class='type'>(<tt>Hash{<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span> =&gt; Object}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Additional extensions to add to the new certificate.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Key/RSA.html" title="Ronin::Support::Crypto::Key::RSA (class)">Key::RSA</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The public/private key pair used with the certificate.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ca_key</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Key/RSA.html" title="Ronin::Support::Crypto::Key::RSA (class)">Key::RSA</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The optional Certificate Authority (CA) key to use to sign the new
certificate.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ca_cert</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The optional Certificate Authority (CA) certificate to attach to the
new certificate.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>signing_hash</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:sha256</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The hashing algorithm to use to sign the new certificate.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The newly generated and signed certificate.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 330</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='label'>version:</span>    <span class='int'>2</span><span class='comma'>,</span>
                  <span class='label'>serial:</span>     <span class='int'>0</span><span class='comma'>,</span>
                  <span class='label'>not_before:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='comma'>,</span>
                  <span class='label'>not_after:</span>  <span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="#ONE_YEAR-constant" title="Ronin::Support::Crypto::Cert::ONE_YEAR (constant)">ONE_YEAR</a></span></span><span class='comma'>,</span>
                  <span class='label'>subject:</span>    <span class='kw'>nil</span><span class='comma'>,</span>
                  <span class='label'>extensions:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                  <span class='comment'># signing arguments
</span>                  <span class='label'>key:</span> <span class='comma'>,</span>
                  <span class='label'>ca_cert:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                  <span class='label'>ca_key:</span>  <span class='kw'>nil</span><span class='comma'>,</span>
                  <span class='label'>signing_hash:</span> <span class='symbol'>:sha256</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span>  <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='kw'>then</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span> <span class='op'>+</span> <span class='int'>1</span>
                 <span class='kw'>else</span>            <span class='id identifier rubyid_serial'>serial</span>
                 <span class='kw'>end</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='id identifier rubyid_not_before'>not_before</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span>  <span class='op'>=</span> <span class='id identifier rubyid_not_after'>not_after</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_key'>key</span>
                    <span class='kw'>when</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>EC</span> <span class='kw'>then</span> <span class='id identifier rubyid_key'>key</span>
                    <span class='kw'>else</span>                        <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
                    <span class='kw'>end</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>    <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_subject'>subject</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span>     <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='kw'>then</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>
                    <span class='kw'>else</span>            <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>
                    <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_extensions'>extensions</span>
    <span class='id identifier rubyid_extension_factory'>extension_factory</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>ExtensionFactory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_subject_certificate'>subject_certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_cert'>cert</span>
    <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_issuer_certificate'>issuer_certificate</span>  <span class='op'>=</span> <span class='id identifier rubyid_ca_cert'>ca_cert</span> <span class='op'>||</span> <span class='id identifier rubyid_cert'>cert</span>

    <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span><span class='id identifier rubyid_critical'>critical</span><span class='rparen'>)</span><span class='op'>|</span>
      <span class='id identifier rubyid_ext'>ext</span> <span class='op'>=</span> <span class='id identifier rubyid_extension_factory'>extension_factory</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span><span class='id identifier rubyid_critical'>critical</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_add_extension'>add_extension</span><span class='lparen'>(</span><span class='id identifier rubyid_ext'>ext</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_signing_key'>signing_key</span>    <span class='op'>=</span> <span class='id identifier rubyid_ca_key'>ca_key</span> <span class='op'>||</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_signing_digest'>signing_digest</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_signing_hash'>signing_hash</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span><span class='lparen'>(</span><span class='id identifier rubyid_signing_key'>signing_key</span><span class='comma'>,</span><span class='id identifier rubyid_signing_digest'>signing_digest</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cert'>cert</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load-class_method">
  
    .<strong>load</strong>(buffer)  &#x21d2; <tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Parses the PEM encoded certificate.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>buffer</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The String containing the certificate.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The parsed certificate.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 210</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_file-class_method">
  
    .<strong>load_file</strong>(path)  &#x21d2; <tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Loads the certificate from the file.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The path to the file.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The loaded certificate.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 223</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Name-class_method">
  
    .<strong>Name</strong>(name)  &#x21d2; <tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Cert::Name</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Coerces a value into a <span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span> object.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>, <tt>Hash</tt>, <tt>OpenSSL::X509::Name</tt>, <tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name value to coerce.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Cert::Name</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name object.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 174</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='const'>Name</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></span> <span class='kw'>then</span> <span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Ronin::Support::Crypto::Cert.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='const'>Hash</span>   <span class='kw'>then</span> <span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build'><span class='object_link'><a href="Cert/Name.html#build-class_method" title="Ronin::Support::Crypto::Cert::Name.build (method)">build</a></span></span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span>   <span class='kw'>then</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>when</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Name</span>
    <span class='id identifier rubyid_new_name'>new_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='period'>.</span><span class='id identifier rubyid_allocate'>allocate</span>
    <span class='id identifier rubyid_new_name'>new_name</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:initialize_copy</span><span class='comma'>,</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new_name'>new_name</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value must be either a String, Hash, or a OpenSSL::X509::Name object: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse-class_method">
  
    .<strong>parse</strong>(string)  &#x21d2; <tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Parses the PEM encoded certificate string.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>string</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The certificate string.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The parsed certificate.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 197</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="common_name-instance_method">
  
    #<strong>common_name</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The subjects common name (<code>CN</code>) entry.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


405
406
407
408
409</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 405</span>

<span class='kw'>def</span> <span class='id identifier rubyid_common_name'>common_name</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_common_name'>common_name</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extension_names-instance_method">
  
    #<strong>extension_names</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The extension OID names.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


416
417
418</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 416</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extension_names'>extension_names</span>
  <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:oid</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extension_value-instance_method">
  
    #<strong>extension_value</strong>(oid)  &#x21d2; <tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Gets the value for the extension with the matching OID.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>oid</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The OID to search for.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The value of the matching extension.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


439
440
441
442
443</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 439</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extension_value'>extension_value</span><span class='lparen'>(</span><span class='id identifier rubyid_oid'>oid</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_ext'>ext</span> <span class='op'>=</span> <span class='id identifier rubyid_find_extension'>find_extension</span><span class='lparen'>(</span><span class='id identifier rubyid_oid'>oid</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_ext'>ext</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extensions_hash-instance_method">
  
    #<strong>extensions_hash</strong>  &#x21d2; <tt>Hash{<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span> =&gt; OpenSSL::X509::Extension}</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Converts the certificate&#39;s extensions into a Hash.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span> =&gt; OpenSSL::X509::Extension}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The Hash of extension OID names and extension objects.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


426
427
428</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 426</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extensions_hash'>extensions_hash</span>
  <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ext'>ext</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_ext'>ext</span><span class='period'>.</span><span class='id identifier rubyid_oid'>oid</span><span class='comma'>,</span> <span class='id identifier rubyid_ext'>ext</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="issuer-instance_method">
  
    #<strong>issuer</strong>  &#x21d2; <tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The issuer of the certificate.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


383
384
385
386
387</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 383</span>

<span class='kw'>def</span> <span class='id identifier rubyid_issuer'>issuer</span>
  <span class='ivar'>@issuer</span> <span class='op'>||=</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='kw'>super</span><span class='rparen'>)</span>
                <span class='const'><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_issuer'>issuer</span><span class='rparen'>)</span>
              <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save-instance_method">
  
    #<strong>save</strong>(path, encoding: :pem)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Saves the certificate to the given path.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The path to write the exported certificate to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>encoding</span>
      
      
        <span class='type'>(<tt>:pem</tt>, <tt>:der</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:pem</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The desired encoding of the exported key.</p>

<ul>
<li><code>:pem</code> - PEM encoding.</li>
<li><code>:der</code> - DER encoding.</li>
</ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>endcoding:</code> value must be either <code>:pem</code> or <code>:der</code>.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


485
486
487
488
489
490
491
492
493
494</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 485</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>encoding:</span> <span class='symbol'>:pem</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_exported'>exported</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_encoding'>encoding</span>
             <span class='kw'>when</span> <span class='symbol'>:pem</span> <span class='kw'>then</span> <span class='id identifier rubyid_to_pem'>to_pem</span>
             <span class='kw'>when</span> <span class='symbol'>:der</span> <span class='kw'>then</span> <span class='id identifier rubyid_to_der'>to_der</span>
             <span class='kw'>else</span>
               <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>encoding: keyword argument (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_encoding'>encoding</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>) must be either :pem or :der</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
             <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="../../../File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span><span class='id identifier rubyid_exported'>exported</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subject-instance_method">
  
    #<strong>subject</strong>  &#x21d2; <tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The subject of the certificate.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


394
395
396
397
398</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 394</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subject'>subject</span>
  <span class='ivar'>@subject</span> <span class='op'>||=</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='kw'>super</span><span class='rparen'>)</span>
                 <span class='const'><span class='object_link'><a href="" title="Ronin::Support::Crypto::Cert (class)">Cert</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Cert/Name.html" title="Ronin::Support::Crypto::Cert::Name (class)">Name</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>
               <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subject_alt_name-instance_method">
  
    #<strong>subject_alt_name</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Retrieves the <code>subjectAltName</code> extension and parses it&#39;s contents.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>subjectAltName</code> value or <code>nil</code> if the certificate does not
have the extension.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


452
453
454</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 452</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subject_alt_name'>subject_alt_name</span>
  <span class='id identifier rubyid_extension_value'>extension_value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subject_alt_names-instance_method">
  
    #<strong>subject_alt_names</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span>&gt;</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Retrieves the <code>subjectAltName</code> extension and parses it&#39;s value.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../../String.html" title="String (class)">String</a></span>&gt;</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The parsed <code>subjectAltName</code> or <code>nil</code> if the certificate does not
have the extension.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


463
464
465
466
467
468
469</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/support/crypto/cert.rb', line 463</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subject_alt_names'>subject_alt_names</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_subject_alt_name'>subject_alt_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Sep 19 15:05:30 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.4).
</div>

    </div>
  </body>
</html>