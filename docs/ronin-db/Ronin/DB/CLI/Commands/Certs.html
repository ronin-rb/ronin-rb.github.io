<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Ronin::DB::CLI::Commands::Certs
  
    &mdash; Ronin::DB Documentation
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Ronin::DB::CLI::Commands::Certs";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../DB.html" title="Ronin::DB (module)">DB</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../CLI.html" title="Ronin::DB::CLI (class)">CLI</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Commands.html" title="Ronin::DB::CLI::Commands (module)">Commands</a></span></span>
     &raquo; 
    <span class="title">Certs</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Ronin::DB::CLI::Commands::Certs
  
  
  <span class="private note title">Private</span>
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../ModelCommand.html" title="Ronin::DB::CLI::ModelCommand (class)">ModelCommand</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Core::CLI::Command</li>
          
            <li class="next"><span class='object_link'><a href="../Command.html" title="Ronin::DB::CLI::Command (class)">Ronin::DB::CLI::Command</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../ModelCommand.html" title="Ronin::DB::CLI::ModelCommand (class)">ModelCommand</a></span></li>
          
            <li class="next">Ronin::DB::CLI::Commands::Certs</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>CommandKit::Printing::Fields, CommandKit::Printing::Indent, CommandKit::Printing::Lists</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ronin/db/cli/commands/certs.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  You should avoid using this class if possible, as it may be removed or be changed in the future.
</p>
<p>Queries or imports SSL/TLS certificates.</p>

<h2 id="usage">Usage</h2>

<pre class="code ruby"><code class="ruby">ronin-db asn [options]
</code></pre>

<h2 id="options">Options</h2>

<pre class="code ruby"><code class="ruby">    --db NAME                    The database to connect to (Default: default)
    --db-uri URI                 The database URI to connect to
    --db-file PATH               The sqlite3 database file to use
-v, --verbose                    Enables verbose output
-A, --active                     Searches for all Certs that are active
-E, --expired                    Searches for all Certs that are expired
    --issuer-common-name NAME    Searches for all Certs with the Issuer Common Name (CN)
    --issuer-organization NAME   Searches for all Certs with the Issuer Organization (O)
    --issuer-organizational-unit NAME
                                 Searches for all Certs with the Issuer Organizational Unit (OU)
    --issuer-locality LOCALITY   Searches for all Certs with the Issuer Locality (L)
    --issuer-state STATE         Searches for all Certs with the Issuer State (ST)
    --issuer-country COUNTRY     Searches for all Certs with the Issuer Country (C)
    --common-name HOST           Searches for all Certs with the Subject Common Name (CN)
    --subject-alt-name HOST      Searches for all Certs with the Subject Alternative Name (SAN)
    --organization NAME          Searches for all Certs with the Subject Organization (O)
    --organizational-unit NAME   Searches for all Certs with the Subject Organizational Unit (OU)
    --locality LOCALITY          Searches for all Certs with the Subject Locality (L)
    --state STATE                Searches for all Certs with the Subject State (ST)
    --country COUNTRY            Searches for all Certs with the Subject Country (C)
    --import FILE                Imports a Cert from a file
-h, --help                       Print help information
</code></pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.2.0</p>
</div>
      
    </li>
  
</ul>

</div>


  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../URIMethods.html" title="Ronin::DB::CLI::URIMethods (module)">URIMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../URIMethods.html#ADAPTER_ALIASES-constant" title="Ronin::DB::CLI::URIMethods::ADAPTER_ALIASES (constant)">URIMethods::ADAPTER_ALIASES</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../ModelCommand.html" title="Ronin::DB::CLI::ModelCommand (class)">ModelCommand</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../ModelCommand.html#query_method_calls-instance_method" title="Ronin::DB::CLI::ModelCommand#query_method_calls (method)">#query_method_calls</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#import_cert-instance_method" title="#import_cert (instance method)">#<strong>import_cert</strong>(path)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Imports a certificate from a file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_cert_org-instance_method" title="#print_cert_org (instance method)">#<strong>print_cert_org</strong>(cert_org)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Prints a certificate Subject or Issuer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_record-instance_method" title="#print_record (instance method)">#<strong>print_record</strong>(cert)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Prints a certificate record.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">#<strong>run</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Runs the <code>ronin-db certs</code> command.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../ModelCommand.html" title="Ronin::DB::CLI::ModelCommand (class)">ModelCommand</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../ModelCommand.html#db_connect-instance_method" title="Ronin::DB::CLI::ModelCommand#db_connect (method)">#db_connect</a></span>, <span class='object_link'><a href="../ModelCommand.html#initialize-instance_method" title="Ronin::DB::CLI::ModelCommand#initialize (method)">#initialize</a></span>, <span class='object_link'><a href="../ModelCommand.html#list-instance_method" title="Ronin::DB::CLI::ModelCommand#list (method)">#list</a></span>, <span class='object_link'><a href="../ModelCommand.html#load_model-instance_method" title="Ronin::DB::CLI::ModelCommand#load_model (method)">#load_model</a></span>, <span class='object_link'><a href="../ModelCommand.html#model-instance_method" title="Ronin::DB::CLI::ModelCommand#model (method)">#model</a></span>, <span class='object_link'><a href="../ModelCommand.html#model_file-class_method" title="Ronin::DB::CLI::ModelCommand.model_file (method)">model_file</a></span>, <span class='object_link'><a href="../ModelCommand.html#model_name-class_method" title="Ronin::DB::CLI::ModelCommand.model_name (method)">model_name</a></span>, <span class='object_link'><a href="../ModelCommand.html#query-instance_method" title="Ronin::DB::CLI::ModelCommand#query (method)">#query</a></span></p>

  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../DatabaseOptions.html" title="Ronin::DB::CLI::DatabaseOptions (module)">DatabaseOptions</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../DatabaseOptions.html#db_config-instance_method" title="Ronin::DB::CLI::DatabaseOptions#db_config (method)">#db_config</a></span>, <span class='object_link'><a href="../DatabaseOptions.html#db_connect-instance_method" title="Ronin::DB::CLI::DatabaseOptions#db_connect (method)">#db_connect</a></span>, <span class='object_link'><a href="../DatabaseOptions.html#included-class_method" title="Ronin::DB::CLI::DatabaseOptions.included (method)">included</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../URIMethods.html" title="Ronin::DB::CLI::URIMethods (module)">URIMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../URIMethods.html#normalize_adapter-instance_method" title="Ronin::DB::CLI::URIMethods#normalize_adapter (method)">#normalize_adapter</a></span>, <span class='object_link'><a href="../URIMethods.html#normalize_sqlite3_path-instance_method" title="Ronin::DB::CLI::URIMethods#normalize_sqlite3_path (method)">#normalize_sqlite3_path</a></span>, <span class='object_link'><a href="../URIMethods.html#parse_uri-instance_method" title="Ronin::DB::CLI::URIMethods#parse_uri (method)">#parse_uri</a></span></p>

  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <span class='object_link'><a href="../ModelCommand.html#initialize-instance_method" title="Ronin::DB::CLI::ModelCommand#initialize (method)">Ronin::DB::CLI::ModelCommand</a></span></p>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="import_cert-instance_method">
  
    #<strong>import_cert</strong>(path)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Imports a certificate from a file.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The path to the certificate file.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/db/cli/commands/certs.rb', line 217</span>

<span class='kw'>def</span> <span class='id identifier rubyid_import_cert'>import_cert</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_file?'>file?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no such file or directory: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_exit'>exit</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='kw'>begin</span>
           <span class='const'><span class='object_link'><a href="../../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'>Support</span><span class='op'>::</span><span class='const'>Crypto</span><span class='op'>::</span><span class='const'>Cert</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
         <span class='kw'>rescue</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>CertificateError</span>
           <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cannot parse the certificate file: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
           <span class='id identifier rubyid_exit'>exit</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
         <span class='kw'>end</span>

  <span class='id identifier rubyid_model'>model</span><span class='period'>.</span><span class='id identifier rubyid_find_or_import'>find_or_import</span><span class='lparen'>(</span><span class='id identifier rubyid_cert'>cert</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_cert_org-instance_method">
  
    #<strong>print_cert_org</strong>(cert_org)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Prints a certificate Subject or Issuer.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cert_org</span>
      
      
        <span class='type'>(<tt>Ronin::DB::CertSubject</tt>, <tt>Ronin::DB::CertIssuer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The Subject or Issuer to print.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/db/cli/commands/certs.rb', line 284</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_cert_org'>print_cert_org</span><span class='lparen'>(</span><span class='id identifier rubyid_cert_org'>cert_org</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_common_name'>common_name</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Common Name (CN)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_common_name'>common_name</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_email_address'>email_address</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email address</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_email_address'>email_address</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Organization (O)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_organizational_unit'>organizational_unit</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Organization Unit (OU)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_organizational_unit'>organizational_unit</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_locality'>locality</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Locality (L)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_locality'>locality</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>State (ST)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_country'>country</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Country (C)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert_org'>cert_org</span><span class='period'>.</span><span class='id identifier rubyid_country'>country</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_print_fields'>print_fields</span><span class='lparen'>(</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_record-instance_method">
  
    #<strong>print_record</strong>(cert)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Prints a certificate record.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cert</span>
      
      
        <span class='type'>(<tt>Ronin::DB::Cert</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The certificate record to print.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/db/cli/commands/certs.rb', line 239</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_record'>print_record</span><span class='lparen'>(</span><span class='id identifier rubyid_cert'>cert</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[ </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_common_name'>common_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span>

  <span class='id identifier rubyid_indent'>indent</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_print_fields'>print_fields</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Serial</span><span class='tstring_end'>&quot;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Not Before</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Not After</span><span class='tstring_end'>&quot;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span>
    <span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span>

    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subject:</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_print_cert_org'>print_cert_org</span><span class='lparen'>(</span><span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_puts'>puts</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject_alt_names'>subject_alt_names</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subject Alt Names:</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_print_list'>print_list</span><span class='lparen'>(</span><span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject_alt_names'>subject_alt_names</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_puts'>puts</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Issuer:</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_print_cert_org'>print_cert_org</span><span class='lparen'>(</span><span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_puts'>puts</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_print_fields'>print_fields</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Public Key Algorithm</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key_algorithm'>public_key_algorithm</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Public Key Size</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key_size'>public_key_size</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Signing Algorithm</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_signing_algorithm'>signing_algorithm</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA1 Fingerprint</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_sha1_fingerprint'>sha1_fingerprint</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA256 Fingerprint</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_sha256_fingerprint'>sha256_fingerprint</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_puts'>puts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-instance_method">
  
    #<strong>run</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Runs the <code>ronin-db certs</code> command.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


201
202
203
204
205
206
207
208
209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/db/cli/commands/certs.rb', line 201</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span>
  <span class='id identifier rubyid_db_connect'>db_connect</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_import_cert'>import_cert</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_list'>list</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Feb 14 23:47:33 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.6).
</div>

    </div>
  </body>
</html>