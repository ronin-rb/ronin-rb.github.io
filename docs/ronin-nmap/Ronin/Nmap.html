<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Ronin::Nmap
  
    &mdash; Ronin::Nmap Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Ronin::Nmap";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (N)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Ronin.html" title="Ronin (module)">Ronin</a></span></span>
     &raquo; 
    <span class="title">Nmap</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Ronin::Nmap
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ronin/nmap.rb<span class="defines">,<br />
  lib/ronin/nmap/cli.rb,<br /> lib/ronin/nmap/root.rb,<br /> lib/ronin/nmap/mixin.rb,<br /> lib/ronin/nmap/version.rb,<br /> lib/ronin/nmap/importer.rb,<br /> lib/ronin/nmap/converter.rb,<br /> lib/ronin/nmap/converters.rb,<br /> lib/ronin/nmap/exceptions.rb,<br /> lib/ronin/nmap/cli/command.rb,<br /> lib/ronin/nmap/cli/port_list.rb,<br /> lib/ronin/nmap/cli/importable.rb,<br /> lib/ronin/nmap/converters/csv.rb,<br /> lib/ronin/nmap/converters/json.rb,<br /> lib/ronin/nmap/cli/commands/new.rb,<br /> lib/ronin/nmap/cli/commands/dump.rb,<br /> lib/ronin/nmap/cli/commands/grep.rb,<br /> lib/ronin/nmap/cli/commands/scan.rb,<br /> lib/ronin/nmap/cli/commands/print.rb,<br /> lib/ronin/nmap/cli/commands/import.rb,<br /> lib/ronin/nmap/cli/commands/convert.rb,<br /> lib/ronin/nmap/cli/filtering_options.rb,<br /> lib/ronin/nmap/cli/commands/completion.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Namespace for the <code>ronin-nmap</code> library.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Nmap/Converter.html" title="Ronin::Nmap::Converter (module)">Converter</a></span>, <span class='object_link'><a href="Nmap/Converters.html" title="Ronin::Nmap::Converters (module)">Converters</a></span>, <span class='object_link'><a href="Nmap/Importer.html" title="Ronin::Nmap::Importer (module)">Importer</a></span>, <span class='object_link'><a href="Nmap/Mixin.html" title="Ronin::Nmap::Mixin (module)">Mixin</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Nmap/CLI.html" title="Ronin::Nmap::CLI (class)">CLI</a></span>, <span class='object_link'><a href="Nmap/Exception.html" title="Ronin::Nmap::Exception (class)">Exception</a></span>, <span class='object_link'><a href="Nmap/NotInstalled.html" title="Ronin::Nmap::NotInstalled (class)">NotInstalled</a></span>, <span class='object_link'><a href="Nmap/ScanFailed.html" title="Ronin::Nmap::ScanFailed (class)">ScanFailed</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="CACHE_DIR-constant" class="">CACHE_DIR =
          <div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This constant is part of a private API.</strong>
  You should avoid using this constant if possible, as it may be removed or be changed in the future.
</p>
<p>The <code>~/.cache/ronin-nmap</code> cache directory.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Core</span><span class='op'>::</span><span class='const'>Home</span><span class='period'>.</span><span class='id identifier rubyid_cache_dir'>cache_dir</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ronin-nmap</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="ROOT-constant" class="">ROOT =
          <div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This constant is part of a private API.</strong>
  You should avoid using this constant if possible, as it may be removed or be changed in the future.
</p>
<p>Path to <code>ronin-nmap</code> root directory.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid___dir__'>__dir__</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="VERSION-constant" class="">VERSION =
          <div class="docstring">
  <div class="discussion">
    <p>ronin-nmap version</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.1.1</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(path)  &#x21d2; ::Nmap::XML </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Parses a nmap XML file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scan-class_method" title="scan (class method)">.<strong>scan</strong>(*targets, sudo: nil, **kwargs) {|nmap| ... } &#x21d2; ::Nmap::XML </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Runs <code>nmap</code> and parses the XML output.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="parse-class_method">
  
    .<strong>parse</strong>(path)  &#x21d2; <tt>::Nmap::XML</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Parses a nmap XML file.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The path to the nmap XML file.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>::Nmap::XML</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The parsed nmap XML file.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://rubydoc.info/gems/ruby-nmap/Nmap/XML" target="_parent" title="https://rubydoc.info/gems/ruby-nmap/Nmap/XML">https://rubydoc.info/gems/ruby-nmap/Nmap/XML</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/nmap.rb', line 220</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='op'>::</span><span class='const'>Nmap</span><span class='op'>::</span><span class='const'>XML</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="scan-class_method">
  
    .<strong>scan</strong>(*targets, sudo: nil, **kwargs) {|nmap| ... } &#x21d2; <tt>::Nmap::XML</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Runs <code>nmap</code> and parses the XML output.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_xml'>xml</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Ronin::Nmap (module)">Nmap</a></span></span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>192.168.1.*</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>syn_scan:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>ports:</span> <span class='lbracket'>[</span><span class='int'>80</span><span class='comma'>,</span> <span class='int'>443</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;Nmap::XML: ...&gt;
</span><span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_up_hosts'>up_hosts</span>
<span class='comment'># =&gt; [#&lt;Nmap::XML::Host: 192.168.1.1&gt;, ...]</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>with a block:</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_xml'>xml</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Ronin::Nmap (module)">Nmap</a></span></span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_nmap'>nmap</span><span class='op'>|</span>
  <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_syn_scan'>syn_scan</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_ports'>ports</span>    <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>80</span><span class='comma'>,</span> <span class='int'>443</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>192.168.1.*</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
<span class='comment'># =&gt; #&lt;Nmap::XML: ...&gt;</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>targets</span>
      
      
        <span class='type'>(<tt>Array&lt;#to_s&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The targets to scan.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sudo</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>, <tt>Boolean</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Controls whether the <code>nmap</code> command should be ran under <code>sudo</code>.
If the <code>sudo:</code> keyword argument is not given, then <code>nmap</code> will
automatically be ran under <code>sudo</code> if <code>sync_scan</code>, <code>ack_scan</code>,
<code>window_scan</code>, <code>maimon_scan</code>, <code>null_scan</code>, <code>fin_scan</code>, <code>xmas_scan</code>,
<code>scan_flags</code>, <code>os_fingerprint</code>, or <code>traceroute</code> are enabled.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>kwargs</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Additional keyword arguments for <code>nmap</code>.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>sudo:</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:askpass</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--askpass</code> <code>sudo</code> option.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:background</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--background</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:bell</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--bell</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:close_from</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--close-from=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:chdir</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--chdir=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:preserve_env</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--preseve-env=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:group</span>
          <span class="type">(<tt>String</tt>, <tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--preseve-env=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:set_home</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--set-home</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:host</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--host=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:login</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--login</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:remove_timestamp</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--remove-timestamp</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:reset_timestamp</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--reset-timestamp</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:non_interactive</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--non-interactive</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:preserve_groups</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--preserve-groups</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:prompt</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--prompt=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:chroot</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--chroot=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:role</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--role=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:stdin</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--stdin</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:shell</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--shell</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--type=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:command_timeout</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--command-timeout=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:other_user</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--other-user=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:user</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Enables the <code>--user=...</code> <code>sudo</code> option</p>
</div>
          
        </li>
      
    </ul>
  
    
    

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>nmap</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>If a block is given, it will be passed the new <code>nmap</code> command object
for additional configuration.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>nmap</span>
      
      
        <span class='type'>(<tt>::Nmap::Command</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>nmap</code> command object.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>::Nmap::XML</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>If the <code>nmap</code> command was successful, the parsed nmap XML data will be
returned.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Nmap/NotInstalled.html" title="Ronin::Nmap::NotInstalled (class)">NotInstalled</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>nmap</code> command was not installed.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Nmap/ScanFailed.html" title="Ronin::Nmap::ScanFailed (class)">ScanFailed</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>nmap</code> scan failed.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://rubydoc.info/gems/ruby-nmap/Nmap/Command" target="_parent" title="https://rubydoc.info/gems/ruby-nmap/Nmap/Command">https://rubydoc.info/gems/ruby-nmap/Nmap/Command</a></li>
    
      <li><a href="https://rubydoc.info/gems/ruby-nmap/Nmap/XML" target="_parent" title="https://rubydoc.info/gems/ruby-nmap/Nmap/XML">https://rubydoc.info/gems/ruby-nmap/Nmap/XML</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/nmap.rb', line 162</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_targets'>targets</span><span class='comma'>,</span> <span class='label'>sudo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kwargs'>kwargs</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nmap'>nmap</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Nmap</span><span class='op'>::</span><span class='const'>Command</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_kwargs'>kwargs</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span> <span class='op'>||=</span> <span class='id identifier rubyid_targets'>targets</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_output_xml'>output_xml</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CACHE_DIR-constant" title="Ronin::Nmap::CACHE_DIR (constant)">CACHE_DIR</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tempfile'>tempfile</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nmap</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.xml</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#CACHE_DIR-constant" title="Ronin::Nmap::CACHE_DIR (constant)">CACHE_DIR</a></span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_output_xml'>output_xml</span> <span class='op'>=</span> <span class='id identifier rubyid_tempfile'>tempfile</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sudo'>sudo</span> <span class='op'>||=</span> <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_syn_scan'>syn_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_ack_scan'>ack_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_window_scan'>window_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_maimon_scan'>maimon_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_null_scan'>null_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_fin_scan'>fin_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_xmas_scan'>xmas_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_scan_flags'>scan_flags</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_ip_scan'>ip_scan</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_os_fingerprint'>os_fingerprint</span> <span class='op'>||</span>
           <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_traceroute'>traceroute</span>

  <span class='comment'># run the nmap command
</span>  <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_sudo'>sudo</span>
           <span class='kw'>when</span> <span class='const'>Hash</span>       <span class='kw'>then</span> <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_sudo_command'>sudo_command</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_sudo'>sudo</span><span class='rparen'>)</span>
           <span class='kw'>when</span> <span class='kw'>true</span>       <span class='kw'>then</span> <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_sudo_command'>sudo_command</span>
           <span class='kw'>when</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>nil</span> <span class='kw'>then</span> <span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_run_command'>run_command</span>
           <span class='kw'>else</span>
             <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sudo keyword must be a Hash, true, false, or nil</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
           <span class='kw'>end</span>

  <span class='comment'># if the command was successful, return the parsed XML, otherwise raises
</span>  <span class='comment'># an exception.
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_status'>status</span>
  <span class='kw'>when</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Nmap/NotInstalled.html" title="Ronin::Nmap::NotInstalled (class)">NotInstalled</a></span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>the nmap command is not installed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Nmap/ScanFailed.html" title="Ronin::Nmap::ScanFailed (class)">ScanFailed</a></span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>nmap scan failed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_command_argv'>command_argv</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='op'>::</span><span class='const'>Nmap</span><span class='op'>::</span><span class='const'>XML</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_nmap'>nmap</span><span class='period'>.</span><span class='id identifier rubyid_output_xml'>output_xml</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Feb 15 00:03:54 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.6).
</div>

    </div>
  </body>
</html>